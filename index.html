<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Na Música Hoje</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;
  background:linear-gradient(180deg,#0f0f0f,#1b0033);
  color:#fff;
}

.screen{
  display:none;
  padding:24px;
}

.active{
  display:block;
}

h1,h2{
  margin:10px 0 20px;
}

button{
  background:#7a2cff;
  border:none;
  color:#fff;
  padding:14px 20px;
  border-radius:14px;
  font-size:16px;
  margin:6px;
  width:100%;
}

button.secondary{
  background:#333;
}

.menu button{
  margin-top:14px;
}

.card{
  display:flex;
  align-items:center;
  background:rgba(255,255,255,0.08);
  margin-bottom:14px;
  padding:14px;
  border-radius:16px;
}

.card img{
  width:72px;
  height:72px;
  border-radius:14px;
  margin-right:14px;
  object-fit:cover;
}

.song{
  background:rgba(255,255,255,0.08);
  border-radius:14px;
  padding:12px;
  margin-bottom:12px;
}

.footer{
  margin-top:30px;
}
</style>
</head>

<body>

<!-- TELA 1 -->
<div id="tela1" class="screen active menu">
  <h1>Na Música Hoje</h1>
  <button onclick="abrirPeriodo('hoje')">HOJE</button>
  <button onclick="abrirPeriodo('ontem')">ONTEM</button>
  <button onclick="abrirPeriodo('semana')">NA SEMANA</button>
  <div class="footer">
    <button class="secondary" onclick="sair()">SAIR</button>
  </div>
</div>

<!-- TELA 2 -->
<div id="tela2" class="screen">
  <h2 id="tituloPeriodo"></h2>
  <div id="listaArtistas">Carregando…</div>
  <div class="footer">
    <button class="secondary" onclick="voltar(1)">VOLTAR</button>
    <button class="secondary" onclick="sair()">SAIR</button>
  </div>
</div>

<!-- TELA 3 -->
<div id="tela3" class="screen">
  <img id="fotoArtista" width="120" style="border-radius:20px"><br><br>
  <h2 id="nomeArtista"></h2>
  <div id="listaMusicas"></div>
  <div class="footer">
    <button class="secondary" onclick="voltar(2)">VOLTAR</button>
    <button class="secondary" onclick="sair()">SAIR</button>
  </div>
</div>

<script>
const API = "https://na-musica-hoje.onrender.com/period?period=";
let artistas = [];

function mostrar(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function sair(){
  window.close();
}

async function abrirPeriodo(periodo){
  mostrar("tela2");
  document.getElementById("tituloPeriodo").innerText = periodo.toUpperCase();
  const lista = document.getElementById("listaArtistas");
  lista.innerHTML = "Carregando…";

  try{
    const r = await fetch(API+periodo);
    const d = await r.json();
    artistas = d.artists || [];

    if(artistas.length === 0){
      lista.innerHTML = "Nenhum lançamento encontrado.";
      return;
    }

    lista.innerHTML = "";
    artistas.forEach((a,i)=>{
      lista.innerHTML += `
        <div class="card" onclick="abrirArtista(${i})">
          <img src="${a.image}">
          <div>${a.artist}</div>
        </div>`;
    });

  }catch{
    lista.innerHTML = "Erro ao carregar dados.";
  }
}

function abrirArtista(i){
  const a = artistas[i];
  document.getElementById("fotoArtista").src = a.image;
  document.getElementById("nomeArtista").innerText = a.artist;

  const lista = document.getElementById("listaMusicas");
  lista.innerHTML = "";

  a.songs.forEach(s=>{
    lista.innerHTML += `
      <div class="song">
        ${s.title}<br><br>
        <button onclick="window.open('${s.youtube}')">YouTube</button>
      </div>`;
  });

  mostrar("tela3");
}

function voltar(t){
  mostrar("tela"+t);
}
</script>

</body>
</html>
